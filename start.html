<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DebAIt ‚Äì Start Debate</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="page">
    <header>
        <div class="logo">Deb<span>AI</span>t</div>
        <div class="tagline">Debate with AI. Practice critical thinking. See both sides.</div>

        <nav class="tabs">
            <a href="index.html" class="tab">Home</a>
            <a href="start.html" class="tab active">Start Debate</a>
            <a href="explore.html" class="tab">Explore Debates</a>
            <a href="about.html" class="tab">About</a>
        </nav>
    </header>

    <section class="section-card">
        <h2>Start a Debate</h2>
        <p>Type a topic or question you want to debate with the AI.</p>

        <textarea id="debate-input" placeholder="Example: Should college be free for all students?"></textarea>
        <button id="ask-button">Ask AI (demo)</button>

        <p class="small-text">
            This is a demo version. It shows a placeholder AI message and lets you build a short debate thread.
        </p>

        <!-- AI response placeholder + thread -->
        <div id="ai-response-box" class="ai-box" style="display: none;">
            <h3>AI response</h3>

            <p class="small-text">
                <strong>Your question:</strong>
                <span id="user-question"></span>
            </p>

            <p class="ai-text">
                AI response coming soon.
            </p>

            <div class="support-row">
                <div class="support-buttons">
                    <button class="support-btn support-yes" id="support-btn">üëç Support</button>
                    <button class="support-btn support-no" id="nosupport-btn">üëé Do not support</button>
                </div>
                <div class="support-counts small-text">
                    Supports: <span id="support-count">0</span> ‚Ä¢
                    Do not support: <span id="nosupport-count">0</span>
                </div>
            </div>

            <p id="support-message" class="small-text"></p>

            <!-- Ongoing debate thread -->
            <div id="debate-thread" class="debate-thread"></div>
        </div>
    </section>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const askButton = document.getElementById('ask-button');
    const input = document.getElementById('debate-input');
    const aiBox = document.getElementById('ai-response-box');
    const userQuestionSpan = document.getElementById('user-question');

    const supportBtn = document.getElementById('support-btn');
    const noSupportBtn = document.getElementById('nosupport-btn');
    const supportMessage = document.getElementById('support-message');
    const supportCountSpan = document.getElementById('support-count');
    const noSupportCountSpan = document.getElementById('nosupport-count');
    const threadContainer = document.getElementById('debate-thread');

    // Read ?topic=... from URL (from Explore page) and prefill the textarea
    const params = new URLSearchParams(window.location.search);
    const topicFromUrl = params.get('topic');
    if (topicFromUrl) {
        input.value = topicFromUrl;
    }

    // Follow-up form container (reused for each round)
    const followUpContainer = document.createElement("div");
    followUpContainer.style.marginTop = "10px";
    followUpContainer.style.display = "none";
    aiBox.appendChild(followUpContainer);

    let supportCount = 0;
    let noSupportCount = 0;
    let roundNumber = 0;
    let currentStance = ""; // "Support" or "Do not support"

    // When the user clicks "Ask AI"
    askButton.addEventListener('click', () => {
        const question = input.value.trim();
        userQuestionSpan.textContent = question || "(No question entered yet.)";

        // Reset state for a fresh debate
        supportCount = 0;
        noSupportCount = 0;
        roundNumber = 0;
        supportCountSpan.textContent = supportCount;
        noSupportCountSpan.textContent = noSupportCount;
        supportMessage.textContent = "";
        supportBtn.classList.remove('selected');
        noSupportBtn.classList.remove('selected');
        followUpContainer.style.display = "none";
        followUpContainer.innerHTML = "";
        threadContainer.innerHTML = ""; // clear previous rounds

        aiBox.style.display = 'block';
    });

    // Simple fake AI reply generator
    function generateAiReply(userText, stance) {
        const baseReplySupport = [
            "That's a thoughtful way to support the position. Another angle is to highlight long-term consequences or equity concerns.",
            "You make a strong supporting point. It could be even stronger if you add a concrete example or statistic.",
            "Your reasoning supports the claim well. You might also explain why alternatives are less convincing."
        ];

        const baseReplyOppose = [
            "Good pushback. To deepen your critique, you could question the assumptions behind the original argument.",
            "You‚Äôve identified a real weakness. Consider adding evidence or a counter-example to make it more persuasive.",
            "Nice challenge to the claim. You might also suggest an alternative solution or middle ground."
        ];

        const list = stance === "Support" ? baseReplySupport : baseReplyOppose;
        const index = Math.floor(Math.random() * list.length);
        return list[index];
    }

    function showFollowUp(questionText) {
        followUpContainer.style.display = "block";
        followUpContainer.innerHTML = `
            <p class="small-text"><strong>${questionText}</strong></p>
            <textarea id="followup-input" placeholder="Write your reasoning here..."></textarea>
            <button id="submit-followup" class="support-btn">Submit</button>
        `;

        document.getElementById('submit-followup').addEventListener('click', () => {
            const answer = document.getElementById('followup-input').value.trim();
            if (answer.length > 0) {
                roundNumber++;

                // Your entry
                const entry = document.createElement("div");
                entry.className = "debate-entry user-entry";
                entry.innerHTML = `
                    <p class="small-text"><strong>Round ${roundNumber} ‚Äì You (${currentStance})</strong></p>
                    <p class="ai-text">${answer}</p>
                `;
                threadContainer.appendChild(entry);

                // AI reply entry
                const aiReplyText = generateAiReply(answer, currentStance);
                const aiEntry = document.createElement("div");
                aiEntry.className = "debate-entry ai-entry";
                aiEntry.innerHTML = `
                    <p class="small-text"><strong>Round ${roundNumber} ‚Äì AI</strong></p>
                    <p class="ai-text">${aiReplyText}</p>
                `;
                threadContainer.appendChild(aiEntry);

                // Hide and clear the follow-up form so they can click buttons again
                followUpContainer.style.display = "none";
                followUpContainer.innerHTML = "";
            }
        });
    }

    // When user supports the AI response
    supportBtn.addEventListener('click', () => {
        supportCount++;
        supportCountSpan.textContent = supportCount;
        supportMessage.textContent = "You chose to support this AI response.";
        supportBtn.classList.add('selected');
        noSupportBtn.classList.remove('selected');
        currentStance = "Support";
        showFollowUp("Why do you support this response?");
    });

    // When user does NOT support the AI response
    noSupportBtn.addEventListener('click', () => {
        noSupportCount++;
        noSupportCountSpan.textContent = noSupportCount;
        supportMessage.textContent = "You chose not to support this AI response.";
        noSupportBtn.classList.add('selected');
        supportBtn.classList.remove('selected');
        currentStance = "Do not support";
        showFollowUp("What was missing or incorrect?");
    });
});
</script>
</body>
</html>
